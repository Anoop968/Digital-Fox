<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Digital Fox OS | Live Sync</title>
    <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-database-compat.js"></script>
    <style>
        :root { --primary: #2563eb; --bg: #f8fafc; --card: #ffffff; --text: #1e293b; --accent: #0ea5e9; --export: #16a34a; }
        body { font-family: 'Inter', sans-serif; background: var(--bg); color: var(--text); margin: 0; display: flex; }
        nav { width: 280px; background: #0f172a; color: white; height: 100vh; padding: 25px; position: fixed; box-sizing: border-box; }
        nav h2 { font-size: 1rem; text-transform: uppercase; letter-spacing: 2px; color: var(--accent); margin-bottom: 30px; border-bottom: 1px solid #1e293b; padding-bottom: 15px; }
        nav ul { list-style: none; padding: 0; }
        nav li { padding: 12px 15px; cursor: pointer; border-radius: 8px; margin-bottom: 8px; transition: 0.2s; font-size: 0.95rem; }
        .active-nav { background: var(--primary) !important; font-weight: 600; }
        main { margin-left: 280px; padding: 50px; width: calc(100% - 280px); box-sizing: border-box; }
        .grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(400px, 1fr)); gap: 30px; }
        .card { background: var(--card); padding: 30px; border-radius: 16px; border: 1px solid #e2e8f0; box-shadow: 0 10px 15px -3px rgba(0,0,0,0.05); position: relative;}
        .progress-container { background: #e2e8f0; height: 10px; border-radius: 5px; margin: 15px 0; overflow: hidden; }
        .progress-bar { height: 100%; background: var(--primary); transition: width 0.5s; width: 0%; }
        textarea, select, input { width: 100%; padding: 12px; margin: 10px 0; border: 2px solid #f1f5f9; border-radius: 10px; font-size: 1rem; }
        button { background: var(--primary); color: white; border: none; padding: 14px; border-radius: 10px; cursor: pointer; font-weight: 700; width: 100%; }
        .report-item { background: #fff; padding: 15px; border-radius: 10px; margin-bottom: 10px; border-left: 5px solid var(--primary); border: 1px solid #eee; }
    </style>
</head>
<body>

<nav>
    <h2>Digital Fox Engine</h2>
    <ul id="menu">
        <li onclick="showSection('planning')" id="nav-planning">Strategic Planning</li>
        <li onclick="showSection('legal')" id="nav-legal">Legal & Compliance</li>
        <li onclick="showSection('rnd')" id="nav-rnd">R&D Exploration</li>
        <li onclick="showSection('design')" id="nav-design">Product Design</li>
        <li onclick="showSection('funding')" id="nav-funding">Finance & Funding</li>
        <li onclick="showSection('presentation')" id="nav-presentation">Presentation</li>
        <hr style="border: 0.5px solid #1e293b; margin: 20px 0;">
        <li onclick="showSection('reports')" id="nav-reports">üìù Submit Report</li>
        <li onclick="showSection('history')" id="nav-history">üìä Live History</li>
    </ul>
</nav>

<main>
    <h1 id="section-title">Connecting to Digital Fox Cloud...</h1>
    <div id="active-section" class="grid"></div>
</main>

<script>
    // YOUR UNIQUE FIREBASE CONFIG (INTEGRATED)
    const firebaseConfig = {
        apiKey: "AIzaSyCHPE9iOu1DZpKD8JjGK7o1pskZhFeqekM",
        authDomain: "digital-fox-79c5c.firebaseapp.com",
        databaseURL: "https://digital-fox-79c5c-default-rtdb.firebaseio.com",
        projectId: "digital-fox-79c5c",
        storageBucket: "digital-fox-79c5c.firebasestorage.app",
        messagingSenderId: "1024069589964",
        appId: "1:1024069589964:web:dd5f35c584a64f148b9b69"
    };

    // Initialize Firebase
    firebase.initializeApp(firebaseConfig);
    const db = firebase.database();

    let startupData = {};

    // Live Sync: Pull data from Firebase
    db.ref('startupData').on('value', (snapshot) => {
        startupData = snapshot.val() || {
            planning: { title: "Strategic Planning", members: "", plan: "", progress: 0, status: "To-Do" },
            legal: { title: "Legal & Compliance", members: "", plan: "", progress: 0, status: "To-Do" },
            rnd: { title: "R&D Exploration", members: "", plan: "", progress: 0, status: "To-Do" },
            design: { title: "Product Design", members: "", plan: "", progress: 0, status: "To-Do" },
            funding: { title: "Finance & Funding", members: "", plan: "", progress: 0, status: "To-Do" },
            presentation: { title: "Presentation", members: "", plan: "", progress: 0, status: "To-Do" },
            reports: []
        };
        const currentTab = document.querySelector('.active-nav')?.id.replace('nav-', '') || 'planning';
        showSection(currentTab);
    });

    function showSection(key) {
        document.querySelectorAll('nav li').forEach(el => el.classList.remove('active-nav'));
        document.getElementById('nav-' + key)?.classList.add('active-nav');
        const container = document.getElementById('active-section');
        const section = startupData[key];
        
        document.getElementById('section-title').innerText = section ? section.title : "Dashboard";

        if(key === 'reports') {
            container.innerHTML = `<div class="card" style="grid-column: 1/-1">
                <label>Member Name</label><input type="text" id="rep-name">
                <label>Block</label><select id="rep-block"><option>Planning</option><option>Legal</option><option>R&D</option><option>Design</option></select>
                <label>Work Summary</label><textarea id="rep-text" rows="5"></textarea>
                <button onclick="saveReport()">Sync Report to Team</button></div>`;
            return;
        }

        if(key === 'history') {
            let reports = startupData.reports || [];
            let html = reports.map(r => `<div class="report-item"><b>${r.name}</b> (${r.block})<br>${r.content}<div style="font-size:0.7rem; color:gray">${r.date}</div></div>`).join('');
            container.innerHTML = `<div style="grid-column: 1/-1">${html}</div>`;
            return;
        }

        container.innerHTML = `
            <div class="card">
                <label>Overall Progress: ${section.progress}%</label>
                <div class="progress-container"><div class="progress-bar" style="width:${section.progress}%"></div></div>
                <input type="range" value="${section.progress}" onchange="db.ref('startupData/${key}/progress').set(this.value)">
            </div>
            <div class="card">
                <label>Assigned Members</label><textarea id="m-${key}">${section.members}</textarea>
                <label>Weekly Plan</label><textarea id="p-${key}" rows="5">${section.plan}</textarea>
                <button onclick="saveBlock('${key}')">Update for All 9 Members</button>
            </div>`;
    }

    function saveBlock(key) {
        const members = document.getElementById('m-'+key).value;
        const plan = document.getElementById('p-'+key).value;
        db.ref('startupData/' + key).update({ members, plan });
        alert("Synced to Cloud!");
    }

    function saveReport() {
        const name = document.getElementById('rep-name').value;
        const block = document.getElementById('rep-block').value;
        const content = document.getElementById('rep-text').value;
        if(!name || !content) return alert("Please fill fields");
        let reports = startupData.reports || [];
        reports.unshift({ name, block, content, date: new Date().toLocaleString() });
        db.ref('startupData/reports').set(reports);
        showSection('history');
    }
</script>
</body>
</html>
